<!DOCTYPE html>
<html>
<meta charset="UTF-8">
  <head>
    <!--Load the AJAX API-->
    <meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="http://www.google.com/uds/modules/gviz/gviz-api.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>  
    <script src="http://code.interactjs.io/v1.2.6/interact.min.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="css/dropzones.css"> -->
    <script  type="text/javascript" src="js/dropzones_edit.js"></script>
    <link rel="stylesheet" type="text/css" href="css/food.css">
    <link rel="stylesheet" type="text/css" href="css/foodforthought.css">

  <style>
    @font-face {
        font-family: UniverseLight;
        src: url(fonts/UniversLTStd-Light.otf) format("opentype");
      }
      @font-face {
        font-family: UniverseLight;
        src: url(fonts/UniversLTStd-Bold.otf) format("opentype");
        font-weight: bold;
      }
      html {
        background: url(img/woodbackground_HR_1920x1080.jpg) no-repeat center center fixed; 
        background-size: cover;
        font-family: UniverseLight;
      }
  </style>  
<script>
var angle = 0;

interact('Calories').gesturable({
  onmove: function (event) {
    var arrow = document.getElementById('');

    angle += event.da;

    arrow.style.webkitTransform =
    arrow.style.transform =
      'rotate(' + angle + 'deg)';

    document.getElementById('angle-info').textContent =
      angle.toFixed(2) + 'Â°';
  }
});
</script>
<script>
//TABLE DROP
interact('.table').dropzone({
  // only accept elements matching this CSS selector
  accept: '#drag1',
  // Require a 75% element overlap for a drop to be possible
  overlap: 0.75,

  // listen for drop related events:
  ondropactivate: function (event) {
    // add active dropzone feedback
    event.target.classList.add('drop-active');
  },
  ondragenter: function (event) {
    var draggableElement = event.relatedTarget,
        dropzoneElement = event.target;

    // feedback the possibility of a drop
    dropzoneElement.classList.add('drop-target');
    draggableElement.classList.add('can-drop');
    draggableElement.textContent = 'Dragged in';
  },
  ondragleave: function (event) {
    // remove the drop feedback style
    event.target.classList.remove('drop-target');
    event.relatedTarget.classList.remove('can-drop');
    event.relatedTarget.textContent = 'Dragged out';
  },
  ondrop: function (event) {
    event.relatedTarget.textContent = 'Dropped';
    console.log("table drop");

    halfsize(event.relatedTarget);            //half image size
    chart_cost_remove(event.relatedTarget);   //remove elem from chart_cost list
    costTable_redraw();                       //redraw table
    calc_cost();  
    // snapback(event.relatedTarget);     //crazy behavior
    reassign_coords(event.relatedTarget);  
  },
  ondropdeactivate: function (event) {
    // remove active dropzone feedback
    event.target.classList.remove('drop-active');
    event.target.classList.remove('drop-target');
  }
});

//PLATE DROP
interact('.plate').dropzone({
  // only accept elements matching this CSS selector
  accept: '#drag1',
  // Require a 75% element overlap for a drop to be possible
  overlap: 0.75,

  // listen for drop related events:
  ondropactivate: function (event) {
    // add active dropzone feedback
    event.target.classList.add('drop-active');
  },
  ondragenter: function (event) {
    var draggableElement = event.relatedTarget,
        dropzoneElement = event.target;

    // feedback the possibility of a drop
    dropzoneElement.classList.add('drop-target');
    draggableElement.classList.add('can-drop');
    draggableElement.textContent = 'Dragged in';
  },
  ondragleave: function (event) {
    // remove the drop feedback style
    event.target.classList.remove('drop-target');
    event.relatedTarget.classList.remove('can-drop');
    event.relatedTarget.textContent = 'Dragged out';
  },
  ondrop: function (event) {
    event.relatedTarget.textContent = 'Dropped';
    console.log("plate drop");
    
    //double image size
    doublesize(event.relatedTarget);
    chart_cost_add(event);
    costTable_redraw();
    calc_cost();
  },
  ondropdeactivate: function (event) {
    // remove active dropzone feedback
    event.target.classList.remove('drop-active');
    event.target.classList.remove('drop-target');
  }
});

    var transformProp;

    interact.maxInteractions(Infinity);

    // setup draggable elements.
    interact('.draggable')
        .on('gesturestart', function (event) {
            event.interaction.x = parseInt(event.target.getAttribute('data-x'), 10) || 0;
            event.interaction.y = parseInt(event.target.getAttribute('data-y'), 10) || 0;
            console.log("hi",event.da);

        })
        .on('gesturemove', function (event) {
            event.interaction.x += event.dx;
            event.interaction.y += event.dy;
            console.log("hi",event.da);


            if (transformProp) {
                event.target.style[transformProp] =
                    'translate(' + event.interaction.x + 'px, ' + event.interaction.y + 'px)';
            }
            else {
                event.target.style.left = event.interaction.x + 'px';
                event.target.style.top  = event.interaction.y + 'px';
            }
        })
        .on('gestureend', function (event) {
            event.target.setAttribute('data-x', event.interaction.x);
            event.target.setAttribute('data-y', event.interaction.y);
        });

  function reassign_coords(target){
    console.log("reassigncoods");
    target.style.top = "0";
    target.style.left = "0";
    // target.setAttribute('transform',translate(-1200px,-1100px));
  }
function snapback(e){
      var transformVals =  window.getComputedStyle(e,null).getPropertyValue('transform');
      var transX = parseInt((transformVals.replace (/,/g, "")).split(" ")[4]); 
      var transY = parseInt((transformVals.replace (/,/g, "")).split(" ")[5]); 

      //convert from 20px to 20, remove 'px' w/ regular expressions
      var top = window.getComputedStyle(e,null).getPropertyValue('top').replace(/[^-\d\.]/g, '');;
      var left = window.getComputedStyle(e,null).getPropertyValue('left').replace(/[^-\d\.]/g, '');;
      var newtransX = transX-left;
      var newtransY = transY-top;

      var value = "translate(" + newtransX + "px," + newtransY + "px);";
      console.log(value);
      // console.log(value);
      // e.style.transform = value;
      e.setAttribute ("style",value);
    }
</script>
</head>
  <body> 

  <div id="outer-dropzone" class="table js-drop"></div>
    <img src= "img/Plate.png" id="inner-dropzone" name="plate" class="plate js-drop" style="transform: translate(700px,-900px);">
    <!-- <div id="inner-dropzone" class="plate js-drop">plate</div> -->
   <img src="img/food/hamburger_HR_icon.png" id="drag1" class="draggable js-drag food"  
   name="Burger"          cost="1.33"  water="462" CO2="15.12"    Cal="191">
   <img src="img/food/steak_HR_icon.png" id="drag1" class="draggable js-drag food" 
   name="Steak"           cost="4.45"  water="923" CO2="54.88"    Cal="552">
   <img src="img/food/cheese_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Cheese"          cost="0.62"  water="76"  CO2="3.78"  Cal="228">
   <img src="img/food/bacon_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Bacon"           cost="0.62"   water="90"  CO2="3.39"  Cal="130" >
   <img src="img/food/chicken_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Chicken"         cost="0.99"  water="259"  CO2="7.73"   Cal="367">
   <img src="img/food/egg_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Egg"                cost="0.37"  water="106"  CO2="2.69"   Cal="154" >
   <img src="img/food/potato_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Potato"           cost="0.39"   water="15"   CO2="13.00"   Cal="117">
   <img src="img/food/fries_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Fries"            cost="0.46"  water="31"  CO2="14.67"  Cal="1084">
   <img src="img/food/chips_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Chips"            cost="0.99"  water="30"  CO2="14.67"  Cal="291">
   <img src="img/food/rice_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Rice"             cost="0.12"  water="37"  CO2="0.75"   Cal="204">
   <img src="img/food/peanutbutter_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Peanut Butter"   cost="0.24"  water="30"  CO2="0.64"   Cal="173">
   <img src="img/food/tofu_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Tofu"            cost="1.04"  water="28"   CO2="1.12"     Cal="176"> 
   <img src="img/food/beans_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Beans"           cost="0.31"  water="2"   CO2="0.0.25"   Cal="157">
   <img src="img/food/lettuce_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Lettuce"         cost="0.16"  water="2"   CO2="0.28"     Cal="8"  >
   <img src="img/food/broccoli_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Broccoli"        cost="0.38"  water="4"   CO2="1.12"     Cal="34" >
   <img src="img/food/corn_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Corn"            cost="0.27"   water="73"  CO2="1.68"     Cal="156">
   <img src="img/food/strawberries_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Strawberry"      cost="0.73"   water="10"   CO2="1.23"   Cal="53" >
   <img src="img/food/tomato_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Tomato"          cost="0.99"  water="24"   CO2="1.23"   Cal="22" >
   <img src="img/food/orange_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Orange"           cost="0.79"  water="21"   CO2="1.85"   Cal="86" >
   <img src="img/food/banana_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Bananas"         cost="0.11"  water="47"   CO2="0.46"   Cal="121">
   <img src="img/food/bread_HR_icon.png" id="drag1" class="draggable js-drag food"
   name="Bread"           cost="0.38"  water="12"  CO2="0.67"   Cal="69" >
  <div id="H20" class="container draggable js-drag gesture-area">
    <div id ="chart_div1" class="chart scale-element"></div>
      <p id="chartline1" class="chartline"></p>
      <p id="chartTotal1" class="chartbase graphpadding">Total: 0</p>
  </div>
 <div id="C02" class="draggable js-drag gesture-area">
      <div id ="chart_div2" class="chart scale-element"></div>
      <p id="chartline2" class="chartline"></p>
      <p id="chartTotal2" class="chartbase graphpadding" style="color:#fdf2e4;">Total: 0</p>
  </div>
  <div id="Calories" class=" container draggable js-drag gesture-area">
      <div id ="chart_div3" class="chart scale-element"></div>
      <p id="chartline3"class="chartline"></p>
      <p id="chartTotal3" class="chartbase graphpadding">Total: 0</p>
  </div>
  <div id="cost" class="container draggable js-drag">
    <table id="table">
			<tr><td width=80 height=50 style="color:#fdf2e4;">Item</td><td width=50>Quantity</td><td width=50>Price</td></tr>
    </table>
    <p class="tableline"></p>
    <p id="totalprice" class="graphpadding">Total $0.00</p>	
  </div>
<br>

 
  </body>

</html>