<!DOCTYPE html>
<html>
<meta charset="UTF-8">
  <head>
    <!--Load the AJAX API-->
    <meta name="viewport" content="minimal-ui, width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="http://www.google.com/uds/modules/gviz/gviz-api.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>  
    <script src="http://code.interactjs.io/v1.2.6/interact.min.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="css/dropzones.css"> -->
    <script  type="text/javascript" src="js/dropzones_edit.js"></script>
    <link rel="stylesheet" type="text/css" href="css/food.css">
    <link rel="stylesheet" type="text/css" href="css/foodforthought.css">

  <style>
    @font-face {
        font-family: UniverseLight;
        src: url(fonts/UniversLTStd-Light.otf) format("opentype");
      }
      @font-face {
        font-family: UniverseLight;
        src: url(fonts/UniversLTStd-Bold.otf) format("opentype");
        font-weight: bold;
      }
      html {
        background: url(img/woodbackground_HR_1920x1080.jpg) no-repeat center center fixed; 
        background-size: cover;
        font-family: UniverseLight;
      }
  </style>  
<script>
var angle = 0;

interact('Calories').gesturable({
  onmove: function (event) {
    var arrow = document.getElementById('');

    angle += event.da;

    arrow.style.webkitTransform =
    arrow.style.transform =
      'rotate(' + angle + 'deg)';

    document.getElementById('angle-info').textContent =
      angle.toFixed(2) + 'Â°';
  }
});
</script>
<script>
//TABLE DROP
interact('.table').dropzone({
  // only accept elements matching this CSS selector
  accept: '#drag1',
  // Require a 75% element overlap for a drop to be possible
  overlap: 0.75,

  // listen for drop related events:
  ondropactivate: function (event) {
    // add active dropzone feedback
    event.target.classList.add('drop-active');
  },
  ondragenter: function (event) {
    var draggableElement = event.relatedTarget,
        dropzoneElement = event.target;

    // feedback the possibility of a drop
    dropzoneElement.classList.add('drop-target');
    draggableElement.classList.add('can-drop');
    draggableElement.textContent = 'Dragged in';
  },
  ondragleave: function (event) {
    // remove the drop feedback style
    event.target.classList.remove('drop-target');
    event.relatedTarget.classList.remove('can-drop');
    event.relatedTarget.textContent = 'Dragged out';
  },
  ondrop: function (event) {
    event.relatedTarget.textContent = 'Dropped';
    console.log("table drop");

    halfsize(event.relatedTarget);            //half image size
    chart_cost_remove(event.relatedTarget);   //remove elem from chart_cost list
    costTable_redraw();                       //redraw table
    calc_cost();  
    // snapback(event.relatedTarget);     //crazy behavior
    // reassign_coords(event.relatedTarget);  
  },
  ondropdeactivate: function (event) {
    // remove active dropzone feedback
    event.target.classList.remove('drop-active');
    event.target.classList.remove('drop-target');
  }
});

//PLATE DROP
interact('.plate').dropzone({
  // only accept elements matching this CSS selector
  accept: '#drag1',
  // Require a 75% element overlap for a drop to be possible
  overlap: 0.75,

  // listen for drop related events:
  ondropactivate: function (event) {
    // add active dropzone feedback
    event.target.classList.add('drop-active');
  },
  ondragenter: function (event) {
    var draggableElement = event.relatedTarget,
        dropzoneElement = event.target;

    // feedback the possibility of a drop
    dropzoneElement.classList.add('drop-target');
    draggableElement.classList.add('can-drop');
    draggableElement.textContent = 'Dragged in';
  },
  ondragleave: function (event) {
    // remove the drop feedback style
    event.target.classList.remove('drop-target');
    event.relatedTarget.classList.remove('can-drop');
    event.relatedTarget.textContent = 'Dragged out';
  },
  ondrop: function (event) {
    event.relatedTarget.textContent = 'Dropped';
    console.log("plate drop");
    
    //double image size
    doublesize(event.relatedTarget);
    chart_cost_add(event);
    costTable_redraw();
    calc_cost();
  },
  ondropdeactivate: function (event) {
    // remove active dropzone feedback
    event.target.classList.remove('drop-active');
    event.target.classList.remove('drop-target');
  }
});

//GESTURE ATTEMPT
    var transformProp;
    var angle = 0;
    var test = document.getElementsByName("Burger");
    // setup draggable elements.
    interact(test).gesturable ({
      onstart: function (event) {
        clearTimeout(resetTimeout);
        scaleElement.classList.remove('reset');
      },
      onmove: function (event) {
        scale = scale * (1 + event.ds);

        scaleElement.style.webkitTransform =
        scaleElement.style.transform =
          'scale(' + scale + ')';

        dragMoveListener(event);
      },
      onend: function (event) {
        resetTimeout = setTimeout(reset, 1000);
        scaleElement.classList.add('reset');
      }
    });

  function reassign_coords(target){
    console.log("reassigncoods");
    // target.style.top = "0";
    // target.style.left = "0";
    // target.setAttribute('transform',translate(-1200px,-1100px));
  }
function snapback(e){
      var transformVals =  window.getComputedStyle(e,null).getPropertyValue('transform');
      var transX = parseInt((transformVals.replace (/,/g, "")).split(" ")[4]); 
      var transY = parseInt((transformVals.replace (/,/g, "")).split(" ")[5]); 

      //convert from 20px to 20, remove 'px' w/ regular expressions
      // var top = window.getComputedStyle(e,null).getPropertyValue('top').replace(/[^-\d\.]/g, '');;
      // var left = window.getComputedStyle(e,null).getPropertyValue('left').replace(/[^-\d\.]/g, '');;
      // var newtransX = transX-left;
      // var newtransY = transY-top;

      var value = "translate(" + transX + "px," + transY + "px);";
      console.log(value);
      // console.log(value);
      // e.style.transform = value;
      e.setAttribute ("style",value); 
      // e.style.top = "0";
      // e.style.left = "0";
    }
</script>
</head>
  <body> 

  <div id="outer-dropzone" class="table js-drop"></div>
    <img src= "img/Plate.png" id="inner-dropzone" name="plate" class="plate js-drop" style="transform: translate(700px,-900px);">
    <!-- <div id="inner-dropzone" class="plate js-drop">plate</div> -->
   <img src="img/food/hamburger_HR_icon.png"    id="drag1" class="draggable js-drag food" name="Burger"          cost="2.05"  water="461.80" CO2="946.69"  Cal="287.0">
   <img src="img/food/steak_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Steak"           cost="4.45"  water="923.36" CO2="4108.95" Cal="414.0">
   <img src="img/food/cheese_HR_icon.png"       id="drag1" class="draggable js-drag food" name="Cheese"          cost="1.86"  water="227.31" CO2="422.80"  Cal="684.0">
   <img src="img/food/bacon_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Bacon"           cost="1.87"  water="539.00" CO2="1007.93" Cal="390.0" >
   <img src="img/food/chicken_HR_icon.png"      id="drag1" class="draggable js-drag food" name="Chicken"         cost="2.48"  water="259.37" CO2="643.24"  Cal="282.0">
   <img src="img/food/egg_HR_icon.png"          id="drag1" class="draggable js-drag food" name="Egg"             cost="0.56"  water="159.00" CO2="88.25"   Cal="231.0">
   <img src="img/food/potato_HR_icon.png"       id="drag1" class="draggable js-drag food" name="Potato"          cost="0.29"  water="11.39"  CO2="3.33"    Cal="90.8">
   <img src="img/food/fries_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Fries"           cost="0.86"  water="31.30"  CO2="26.92"   Cal="558.0">
   <img src="img/food/chips_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Chips"           cost="1.49"  water="45.00"  CO2="66.83"   Cal="900.0">
   <img src="img/food/rice_HR_icon.png"         id="drag1" class="draggable js-drag food" name="Rice"            cost="0.72"  water="56.09"  CO2="40.38"   Cal="306.0">
   <img src="img/food/peanutbutter_HR_icon.png" id="drag1" class="draggable js-drag food" name="Peanut Butter"   cost="1.44"  water="178.38" CO2="256.87"  Cal="1038.0">
   <img src="img/food/tofu_HR_icon.png"         id="drag1" class="draggable js-drag food" name="Tofu"            cost="1.56"  water="213.90" CO2="333.68"  Cal="264.0"> 
   <img src="img/food/beans_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Beans"           cost="0.31"  water="2.43"   CO2="0.75"    Cal="157.0">
   <img src="img/food/lettuce_HR_icon.png"      id="drag1" class="draggable js-drag food" name="Lettuce"         cost="0.96"  water="11.28"  CO2="10.83"   Cal="48.0">
   <img src="img/food/broccoli_HR_icon.png"     id="drag1" class="draggable js-drag food" name="Broccoli"        cost="0.57"  water="5.75"   CO2="3.27"    Cal="12.0">
   <img src="img/food/corn_HR_icon.png"         id="drag1" class="draggable js-drag food" name="Corn"            cost="0.27"  water="73.08"  CO2="19.73"   Cal="156.0">
   <img src="img/food/strawberries_HR_icon.png" id="drag1" class="draggable js-drag food" name="Strawberry"      cost="0.73"  water="9.91"   CO2="7.23"    Cal="53.0">
   <img src="img/food/tomato_HR_icon.png"       id="drag1" class="draggable js-drag food" name="Tomato"          cost="0.74"  water="18.00"  CO2="13.37"   Cal="16.5">
   <img src="img/food/orange_HR_icon.png"       id="drag1" class="draggable js-drag food" name="Orange"          cost="1.19"  water="25.16"  CO2="29.81"   Cal="129.0">
   <img src="img/food/banana_HR_icon.png"       id="drag1" class="draggable js-drag food" name="Bananas"         cost="0.30"  water="94.64"  CO2="28.39"   Cal="242.0">
   <img src="img/food/bread_HR_icon.png"        id="drag1" class="draggable js-drag food" name="Bread"           cost="1.14"  water="72.12"  CO2="82.22"   Cal="207.0">
  <div id="H20" class="container draggable js-drag gesture-area">
    <div id ="chart_div1" class="chart scale-element"></div>
      <p id="chartline1" class="chartline"></p>
      <p id="chartTotal1" class="chartbase graphpadding">Total: 0</p>
  </div>
 <div id="C02" class="container draggable js-drag gesture-area">
      <div id ="chart_div2" class="chart scale-element"></div>
      <p id="chartline2" class="chartline"></p>
      <p id="chartTotal2" class="chartbase graphpadding" style="color:#fdf2e4;">Total: 0</p>
  </div>
  <div id="Calories" class=" container draggable js-drag gesture-area">
      <div id ="chart_div3" class="chart scale-element"></div>
      <p id="chartline3"class="chartline"></p>
      <p id="chartTotal3" class="chartbase graphpadding">Total: 0</p>
  </div>
  <div id="cost" class="container draggable js-drag">
    <table id="table">
			<tr><td width=80 height=50 style="color:#fdf2e4;">Item</td><td width=50>Quantity</td><td width=50>Price</td></tr>
    </table>
    <p class="tableline"></p>
    <p id="totalprice" class="graphpadding">Total $0.00</p>	
  </div>
<br>

 
  </body>

</html>